---
title: "Proje Adı"
format: html
number-sections: true
---

**Proje sayfamıza hoş geldiniz.**

![](veri/2008.gif){fig-align="center"}



# Proje Genel Bakış ve Kapsamı

xxxxxx

# Veri



## Veri Kaynağı

xxxxxx

## Veri Hakkında Genel Bilgiler

xxxxxx

## Tercih Sebebi

xxxxxx

## Ön İşleme

```{r}
#| echo: false
#| results: "hide"
#| message: false
#| warning: false
library(patchwork)
library(readxl) 
library(openxlsx) 
library(dplyr)
library(ggplot2) 
library(tidyr) 
library(stringr) 
library(scales) 
library(plotly)
library(ggrepel) 
library(ggthemes)
library(kableExtra)
library(readxl)
library(RColorBrewer)
library(fmsb)

```

### YILLARA GÖRE BOŞANMA SAYISI VE KABA BOŞANMA HIZ GRAFİĞİ

-   Boşanma konusunda ilk olarak yıllara göre boşanma sayısı verisi ele alındı.
-   Bu veri setinde inceleme yapılırken boşanma sayısılarında nüfus artış etkisini de gözlemleyebilmek adına kaba boşanma hızı incelemeye dahil edildi.
-   Kaba boşanma hızı, bir yıl içinde evlenebilecek yaştaki her 1000 nüfus başına düşen boşanma sayısıdır.

```{r, fig.width=15, fig.height=9}
# Excel dosyasını oku
evlilik_bosanma_hiz <- read_excel("veri/evlilik-bosanma-nufus.xls")

# Kaba bosanma hızı hesaplaması
evlilik_bosanma_hiz <- evlilik_bosanma_hiz %>%
  mutate(
    Yil = as.numeric(Yil),
    Kaba_Bosanma_Hizi = (Bosanma_Sayisi / Nufus_Sayisi) * 1000
  )

# Çizgi verisi hazırlığı
hizlar <- evlilik_bosanma_hiz %>%
  select(Yil, Kaba_Bosanma_Hizi) %>%
  pivot_longer(cols = Kaba_Bosanma_Hizi, names_to = "Kaba_Bosanma_Hizi", values_to = "Deger") %>%
  mutate(
    Kaba_Bosanma_Hizi = "Kaba bosanma hızı",
    Etiket = paste0(format(round(Deger, 2), nsmall = 2), " "),
    Y_Pos = Deger * 80000
  )

# Barplot çizimi
hizlar$Kategori <- "Kaba bosanma hızı"

ggplot() +
  geom_bar(data = evlilik_bosanma_hiz,
           aes(x = Yil, y = Bosanma_Sayisi, fill = "Bosanma Sayısı"),
           stat = "identity") +

  geom_text(data = evlilik_bosanma_hiz,
            aes(x = Yil, y = Bosanma_Sayisi,
                label = format(Bosanma_Sayisi)),
            angle = 90, vjust = 0.5, hjust = 3,
            color = "black", size = 5) +

  geom_line(data = hizlar,
            aes(x = Yil, y = Y_Pos, color = Kategori, group = 1),
            linewidth = 1.2) +
  geom_point(data = hizlar,
             aes(x = Yil, y = Y_Pos),
             size = 2.5,color = "purple") +
  geom_text(data = hizlar,
            aes(x = Yil, y = Y_Pos, label = Etiket),
            vjust = -1.5, size = 4,color="purple" ) +

scale_fill_manual(values = c("Bosanma Sayısı" = "pink"), name = NULL) +
scale_color_manual(values = c("Kaba bosanma hızı" = "purple"), name = NULL) +

  scale_y_continuous(
    name = "Bosanma Sayısı",
    sec.axis = sec_axis(~./80000, name = "Kaba hız (Binde)")
  ) +
  scale_x_continuous(breaks = evlilik_bosanma_hiz$Yil) +
  labs(
    title = "Yıllara Gore Bosanma Sayısı ve Kaba Bosanma Hızının Karsılastırılması",
    x = "Yıl"
  ) +
  theme_minimal(base_size = 20) +
  theme(
    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1,size = 12, face = "bold"),
    axis.title.x = element_text(color = "black", size = 14, face = "bold"),
    axis.title.y = element_text(color = "black", size = 14, face = "bold"),
    axis.title.y.right = element_text(color = "black", size = 14, face = "bold"),
    plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
    legend.title = element_text(face = "bold"),
    legend.position = "bottom"
  )
```

-   Bu grafik, 2007 ile 2024 yılları arasındaki boşanma sayısı ve kaba boşanma hızının ilişkisini göstermektedir. Boşanma sayısı pembe sütunlarla, kaba boşanma hızı ise mor noktalarla ifade edilmiştir.

-   Yıllar içerisinde boşanma sayısında düzensiz bir artış trendi gözlemlenmektedir. Kaba boşanma hızı yıllar içinde artış göstermiştir. Kaba boşanma hızındaki artış, boşanma sayısındaki artış ile paralellik göstermektedir. Kaba boşanma hızındaki artış, boşanma oranların artmaya devam ettiğini ve toplumsal normların değişmesiyle boşanmanın daha yaygın hale geldiği düşünülebilir.

-   2020 yılındaki kritik düşüş pandemi sürecinde ülkemizde yaşanan kapanma, resmi süreçlerin aksaması, mahkemelerin ve davaların gerçekleştirilememesi gibi sebeplerden kaynaklı gerçekleşmiş olabilir.

-   2021 yılındaki kritik artış; pandemi sebebiyle 2020 yılında gerçekleştirilemeyen ve 2021 yılına devredilen davalar sebep olmuş olabilir. Bir diğer sebep ise pandemi sürecindeki aile içi ilişkilerde yaşanan zorluklar neticesinde daha fazla boşanma kararının alınması olabilir.

-   Boşanma verileri incelendiğinde, ani artış veya azalışların ülkemizde yaşanan ekonomik kriz, OHAL, deprem felaketi gibi olağanüstü olayların etkili olduğu düşünülmektedir.  (2008-2009: Ekonomik Kriz, 2016 : OHAL, 2023 : Deprem Felaketi )

```{r, fig.width=15, fig.height=9}
#Kaba evlenme hızı hesapla
evlilik_bosanma_hiz <- read_excel("veri/evlilik-bosanma-nufus.xls")

evlilik_bosanma_hiz <- evlilik_bosanma_hiz %>%
  mutate(
    Yil = as.numeric(Yil),
    Kaba_Evlenme_Hizi = (Evlenme_Sayisi / Nufus_Sayisi) * 1000
  )


hizlar <- evlilik_bosanma_hiz %>%
  select(Yil, Kaba_Evlenme_Hizi) %>%
  pivot_longer(
    cols = Kaba_Evlenme_Hizi,
    names_to = "Kaba_Evlenme_Hizi",
    values_to = "Deger"
  ) %>%
  mutate(
    Kaba_Evlenme_Hizi = "Kaba evlenme hızı",  # Legend için sabit isim
    Etiket = paste0(format(round(Deger, 2), nsmall = 2), " "),
    Y_Pos = Deger * 80000,
    Kategori = "Kaba evlenme hızı"
  )

ggplot() +
  geom_bar(
    data = evlilik_bosanma_hiz,
    aes(x = Yil, y = Evlenme_Sayisi, fill = "Evlenme Sayısı"),
    stat = "identity"
  ) +
  geom_text(
    data = evlilik_bosanma_hiz,
    aes(x = Yil, y = Evlenme_Sayisi, label = format(Evlenme_Sayisi)),
    angle = 90, vjust = 0.5, hjust = 3,
    color = "white", size = 5
  ) +
  geom_line(
    data = hizlar,
    aes(x = Yil, y = Y_Pos, color = Kaba_Evlenme_Hizi, group = 1),
    size = 1.2
  ) +
  geom_point(
    data = hizlar,
    aes(x = Yil, y = Y_Pos, color = Kaba_Evlenme_Hizi),
    size = 4
  ) +
  geom_text(
    data = hizlar,
    aes(x = Yil, y = Y_Pos, label = Etiket),
    color = "darkred",
    vjust = -1, size = 4,
    show.legend = FALSE
  ) +
  scale_fill_manual(values = c("Evlenme Sayısı" = "cornflowerblue"), name = NULL) +
  scale_color_manual(values = c("Kaba evlenme hızı" = "darkred"), name = NULL) +
  scale_y_continuous(
    name = "Evlenme sayısı",
    sec.axis = sec_axis(~./80000, name = "Kaba hız (Binde)")
  ) +
  scale_x_continuous(breaks = evlilik_bosanma_hiz$Yil) +
  labs(
    title = "Yıllara Gore Evlenme Sayısı ve Kaba Evlenme Hızı",
    x = "Yıl"
  ) +
theme_minimal(base_size = 20) +
  theme(
    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1,size = 12, face = "bold"),
    axis.title.y = element_text(color = "black", size = 14, face = "bold"),
    axis.title.x = element_text(color = "black", size = 14, face = "bold"),
    axis.title.y.right = element_text(color = "black", size = 14, face = "bold"),
    plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
    legend.title = element_text(face = "bold",size=6),
    legend.position = "bottom"
  )



```

```{r, fig.width=10, fig.height=5}


turkiye_geneli <- read_excel("veri/turkiye_geneli.xlsx")

Durum <- c("evlenme_sayisi","bosanma_sayisi")

grafik <- turkiye_geneli |> ggplot() +
  geom_line(aes(x = yil, y = evlenme_sayisi, color = "Evlenme Sayısı",group=1), linewidth = 1.7) +
  geom_line(aes(x = yil, y = bosanma_sayisi, color = "Bosanma Sayısı",group=1), linewidth = 1.7) +
  scale_color_manual(values = c("Evlenme Sayısı" = "cornflowerblue", "Bosanma Sayısı" = "pink")) +
  scale_y_continuous(breaks = seq(0, 700000, by = 50000), labels = comma) +
  labs(
    title = "Turkiye'de Yıllara Gore Evlenme ve Bosanma Sayıları",
    x = "Yıl",
    y = "Kişi Sayısı",
    color = "Durum") +
  theme_minimal()+theme(axis.text.x = element_text(angle = 90, vjust = 1, face ="bold"))+theme(axis.title = element_text(hjust = 0.5, size = 14,face = "bold"),plot.title=element_text(hjust = 0.5, size = 14,face= "bold"))
grafik
```

```{r, fig.width=10, fig.height=10}

ulkeler_arasi <- read_excel("veri/Dunya_ve_Turkiye_bosanma_kaba_hizi.xlsx")

ulkeler_arasi$`Bosanma_Kaba_Hizi` <- as.numeric(gsub(",", ".", ulkeler_arasi$`Bosanma_Kaba_Hizi`))


ulkeler_arasi <- ulkeler_arasi %>% arrange(Bosanma_Kaba_Hizi)


ggplot(ulkeler_arasi, aes(x= `Bosanma_Kaba_Hizi`, y= reorder(Ulke, `Bosanma_Kaba_Hizi`))) +
  geom_bar(stat = "identity", fill = "dark red",width = 0.75) +
  labs(
    title = "2022 Yılı Ülkelerde Bosanma Kaba Hızı",
    x = "Bosanma Kaba Hızı Binde",
    y = "Ulke") +theme_minimal()+
 theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.title.x = element_text(face = "bold", size = 14),
    axis.title.y = element_text(face = "bold", size = 12),
    axis.text.x  = element_text(face = "bold", size = 12),
    axis.text.y  = element_text(face = "bold", size = 12)
  ) + geom_text(
    data = ulkeler_arasi,
    aes(x =Bosanma_Kaba_Hizi , y = Ulke, label = format(Bosanma_Kaba_Hizi)),
    angle = 0, vjust = 0.5, hjust = 1,
    color = "white", size = 5
  )
```

```{r, fig.width=10, fig.height=10}
#En büyük 10 şehir kıyaslama piramid
Iik_10_Sehir_Bosanma <- read_excel("veri/Iik_10_Sehir_Bosanma.xlsx")
head(Iik_10_Sehir_Bosanma)
# Uzun form ve piramit formatı
veri_long <- Iik_10_Sehir_Bosanma %>%
  pivot_longer(cols = starts_with("Oran"), names_to = "Yil", values_to = "Oran") %>%
  mutate(
    Yil = str_replace(Yil, "Oran_", ""),
    Oran = ifelse(Yil == "2010", -Oran, Oran), # 2010 sola, 2024 sağa
    Il = factor(Il, levels = rev(unique(Il)))  # İl sıralaması yukarıdan aşağı
  )

ggplot(veri_long, aes(x = Il, y = Oran, fill = Yil)) +
  geom_bar(stat = "identity",width = 0.65) +
 geom_text(
  aes(label = sprintf("%.1f", abs(Oran))),
  position = position_stack(vjust = 0.5),
  size = 5,color = "white")+
  coord_flip() +
  scale_y_continuous(labels = abs) +
  scale_fill_manual(values = c("2010" = "skyblue", "2024" = "darkorange")) +
  labs(
    title = "2010 ve 2024 Yıllarına Gore En Kalabalık 10 Sehirin Bosanma Oranları ",
    x = "İl",
    y = "Oran (%)",
    fill = "Yıl"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold",size=18),
    axis.text.y = element_text(hjust = 0.5,size = 12),  
    axis.title.y = element_text(hjust = 0.5,size = 14,face="bold"),  
    axis.title.x = element_text(hjust = 0.5,size = 14,face="bold"),  
    legend.position = "top"
  )
```

```{r, fig.width=15, fig.height=10}
#2010 yılındaki Nufüsa Göre Boşanma oranının en az olduğu 10 Şehrin Gösterimi
#Evlenme_bosanma_orani_2010_az

Evlenme_bosanma_orani_2010_az <- read_excel("veri/Evlenme_bosanma_orani_2010_az.xlsx")
str(Evlenme_bosanma_orani_2010_az)

p1<-Evlenme_bosanma_orani_2010_az|> ggplot(aes(x=Il, y=Oran)) + geom_bar(stat = "identity", fill = "skyblue",width = 0.5)+labs(title = "Bosanma Sayısının Evlilige Oranının En Az Oldugu İller - 2010",
    x = "İl",
    y = "Bosanmanın Evlilige Oranı")+theme_light()+theme(plot.title = element_text(hjust = 0.5, size = 12, face = "bold"))+geom_text(aes(label = sprintf("%.1f", Oran)), vjust = -0.5,size =4,fontface = "bold")+ylim(0, 15)

#2024 yılındaki Nufüsa Göre Boşanma oranının en az olduğu 10 Şehrin Gösterimi

Evlenme_bosanma_orani_2024_az <- read_excel("veri/Evlenme_bosanma_orani_2024_az.xlsx")
str(Evlenme_bosanma_orani_2024_az)


p2<-Evlenme_bosanma_orani_2024_az|> ggplot(aes(x=Il, y=Oran)) + geom_bar(stat = "identity", fill = "red",width = 0.5)+labs(title = "Bosanma Sayısının Evlilige Oranının En Az Oldugu İller - 2024",
    x = "Il",
    y = "Bosanmanın Evlilige Oranı")+theme_light()+theme(plot.title = element_text(hjust = 0.5, size = 12, face = "bold"))+geom_text(aes(label = sprintf("%.1f", Oran)), vjust = -0.5,size =4,fontface = "bold")+ylim(0, 15)

#2010 yılındaki Nufüsa Göre Boşanma oranının en çok olduğu 10 Şehrin Gösterimi


Evlenme_bosanma_orani_2010_cok <- read_excel("veri/Evlenme_bosanma_orani_2010_cok.xlsx")
str(Evlenme_bosanma_orani_2010_cok)

p3<-Evlenme_bosanma_orani_2010_cok|> ggplot(aes(x=Il, y=Oran)) + geom_bar(stat = "identity", fill = "skyblue",width = 0.5)+labs(title = "Bosanma Sayısının Evlilige Oranının En Cok Oldugu İller - 2010",
    x = "İl",
    y = "Bosanmanın Evlilige Oranı")+theme_light()+theme(plot.title = element_text(hjust = 0.5, size = 12, face = "bold"))+geom_text(aes(label = sprintf("%.1f", Oran)), vjust = -0.5,size =4,fontface = "bold")+ylim(0, 70)

#2024 yılındaki Nufüsa Göre Boşanma oranının en çok olduğu 10 Şehrin Gösterimi
Evlenme_bosanma_orani_2024_cok <- read_excel("veri/Evlenme_bosanma_orani_2024_cok.xlsx")
str(Evlenme_bosanma_orani_2024_cok)

p4<-Evlenme_bosanma_orani_2024_cok|> ggplot(aes(x=Il, y=Oran)) + geom_bar(stat = "identity", fill = "red",width = 0.5)+labs(title = "Bosanma Sayısının Evlilige Oranının En Cok Oldugu İller - 2024",
    x = "İl",
    y = "Bosanmanın Evlilige Oranı")+theme_light()+theme(plot.title = element_text(hjust = 0.5, size = 12, face = "bold"))+geom_text(aes(label = sprintf("%.1f", Oran)), vjust = -0.5,size =4,fontface = "bold" )+ylim(0, 70)


ortak_tema <- theme(
  plot.title = element_text(size = 16),
  axis.text = element_text(size = 12,angle = 90,face ="bold"),
  axis.title = element_text(size = 14,face ="bold")
)

p1 <- p1 + ortak_tema
p2 <- p2 + ortak_tema
p3 <- p3 + ortak_tema
p4 <- p4 + ortak_tema

(p1|p2)
(p3|p4)

```

## Kadın 2006-2021 bosanma nedenleri

```{r, fig.width=10, fig.height=10}
veri <- read_excel("veri/Bosanma_sebepleri_2006_2021.xlsx")

veri_long <- veri %>%
  pivot_longer(cols = -Bosanma_Nedeni, names_to = "Grup", values_to = "Yuzde") %>%
  mutate(Yuzde = as.numeric(gsub(",", ".", Yuzde))) %>%
  filter(Grup %in% c("Kadin_2006", "Kadin_2021"))
ggplot(veri_long, aes(x = Bosanma_Nedeni, y = Yuzde, fill = Grup)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.7) +
  geom_text(aes(label = round(Yuzde, 1)), 
            position = position_dodge(width = 1), 
            vjust = -1.5, size = 5) +
  labs(
    title = "2006 ve 2021 Yıllarında Kadınların Bosanma Nedenleri",
    x = "Bosanma Nedeni",
    y = "Yuzde (%)",
    fill = "Yıl"
  ) +
  theme_minimal(base_size = 20) +
 theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 18),
    axis.title.x = element_text(face = "bold", size = 14),
    axis.title.y = element_text(face = "bold", size = 14),
    axis.text.x = element_text(angle = 70, hjust = 1, size = 12,face = "bold")
  )+
  scale_fill_manual(values = c("Kadin_2006" = "pink", "Kadin_2021" = "dark red")) +
  coord_cartesian(ylim = c(0, max(veri_long$Yuzde) + 7)) 
```

```{r, fig.width=15, fig.height=10}
## erkek 2006-2021 bosanma nedenleri

veri_long <- veri %>%
  pivot_longer(cols = -Bosanma_Nedeni, names_to = "Grup", values_to = "Yuzde") %>%
  mutate(Yuzde = as.numeric(gsub(",", ".", Yuzde))) %>%
  filter(Grup %in% c("Erkek_2006", "Erkek_2021"))

ggplot(veri_long, aes(x = Bosanma_Nedeni, y = Yuzde, fill = Grup)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.7) +
  geom_text(aes(label = round(Yuzde, 1)), 
            position = position_dodge(width = 1), 
            vjust = -1.5, size = 5) +
  labs(
    title = "2006 ve 2021 Yıllarında Erkeklerin Bosanma Nedenleri",
    x = "Bosanma Nedeni",
    y = "Yuzde (%)",
    fill = "Yıl"
  ) +
  theme_minimal(base_size = 20) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 18),
    axis.title.x = element_text(face = "bold", size = 14),
    axis.title.y = element_text(face = "bold", size = 14),
    axis.text.x = element_text(angle = 70, hjust = 1,face="bold",size=12)
  )+
  scale_fill_manual(values = c("Erkek_2006" = "sky blue", "Erkek_2021" = "dark blue")) +
  coord_cartesian(ylim = c(0, max(veri_long$Yuzde) + 7))
```

```{r, fig.width=12, fig.height=10}

GSYH <- read_excel("veri/GSYH.xlsx")

GSYH$Kategori <- "Kaba Bosanma Hızı"
GSYH$Kategori2 <- "Kisi Basına GSYH"

ggplot() +
  geom_bar(data = GSYH, 
           aes(x = Yil, y = Kisi_Basi_GSYH, fill = Kategori2), 
           stat = "identity") +
  geom_text(data = GSYH, 
            aes(x = Yil, y = Kisi_Basi_GSYH, 
                label = format(Kisi_Basi_GSYH, nsmall = 2)),
            angle = 90, vjust = 0.5, hjust = 1.5, 
            color = "white", size = 5) +
  geom_line(data = GSYH, 
            aes(x = Yil, y = Kaba_Bosanma_Hizi * 6000, color = Kategori), 
            size = 1.2) +
  geom_point(data = GSYH, 
             aes(x = Yil, y = Kaba_Bosanma_Hizi * 6000, color = Kategori), 
             size = 2.75) +
  geom_text(data = GSYH, 
            aes(x = Yil, y = Kaba_Bosanma_Hizi * 6000, 
                label = round(Kaba_Bosanma_Hizi, 2), color = Kategori), 
            vjust = -1, size = 5, show.legend = FALSE) +
scale_fill_manual(values = c("Kisi Basına GSYH" = "#1b9e77"), name = NULL) +
scale_color_manual(values = c("Kaba Bosanma Hızı" = "#e6550d"), name = NULL)+
  scale_y_continuous(
    name = "Kisi Basına GSYH", 
    sec.axis = sec_axis(~./6000, name = "Kaba hız (Binde)")
  ) +
  scale_x_continuous(breaks = GSYH$Yil) +
  labs(
    title = "Yillara Gore Kaba Bosanma Sayisi ve Kisi Basina GSYH Karsılastırılması",
    x = "Yıl"
  ) +

  theme_minimal(base_size = 20) +
  theme(
    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1,size=12,face = "bold"),
    axis.title.x = element_text(color = "black", size = 14,face = "bold"),
    axis.title.y = element_text(color = "black", size = 14,face = "bold"),
    axis.title.y.right = element_text(color = "black", size = 14,face = "bold"),
    plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
    legend.position = "bottom"
  )
```

```{r, fig.width=10, fig.height=6}


# Evlilik süresine göre boşanma sayısı grafiği

evlilik_suresi<- read_excel("veri/Evlilik_suresi_Turkiye_geneli.xlsx")


yildan_az_1<-sum(evlilik_suresi[2])
yil_1_5<-sum(evlilik_suresi[3:7])
yil_6_10<-sum(evlilik_suresi[8:12])
yil_11_15<-sum(evlilik_suresi[13:17])
yil_16_20<-sum(evlilik_suresi[18:22])
bosanma_sayisi <- data.frame(
  Evlilik_Suresi = c("0-1 yıldan az", "1-5 yıl", "6-10 yıl", "11-15 yıl", "16-20+ yıl"),
  total_bosanma_sayisi<-c(yildan_az_1,yil_1_5,yil_6_10,yil_11_15,yil_16_20)
)
bosanma_sayisi$Evlilik_Suresi <- factor(
  bosanma_sayisi$Evlilik_Suresi,
  levels = c("0-1 yıldan az", "1-5 yıl", "6-10 yıl", "11-15 yıl", "16-20+ yıl")
)
bosanma_sayisi|> ggplot(aes(x=Evlilik_Suresi, y=total_bosanma_sayisi)) + geom_bar(stat = "identity", fill = "skyblue",width = 0.5)+ geom_text(aes(label = total_bosanma_sayisi), vjust = -0.5, size = 4)+labs(title = "Evlilik Suresine Gore Bosanma Sayısı",
    x = "Evlilik Suresi",
    y = "Toplam Boşanma Sayısı")+theme_minimal()+
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),axis.title.x = element_text(color = "black", size = 12,face = "bold"),
    axis.title.y = element_text(color = "black", size = 12,face = "bold"),axis.text.x = element_text(angle = 0, vjust = 10, hjust = 0.5,size=10,face = "bold"))

```

```{r, fig.width=12, fig.height=10}
# (Evlilik süresi ve boşanma sayısının yıllara göre karşılaştırılması)
yillar_0_1<-vector()
for (i in seq(1,24)){
  yillar_0_1[i]<-sum(evlilik_suresi[i,2])
}
yillar_1_5<-vector()
for (i in seq(1,24)){
  yillar_1_5[i]<-sum(evlilik_suresi[i,3:7])
}

yillar_6_10<-vector()
for (i in seq(1,24)){
  yillar_6_10[i]<-sum(evlilik_suresi[i,8:12])
}
yillar_11_15<-vector()
for (i in seq(1,24)){
  yillar_11_15[i]<-sum(evlilik_suresi[i,13:17])
}

yillar_16_20<-vector()
for (i in seq(1,24)){
  yillar_16_20[i]<-sum(evlilik_suresi[i,18:22])
}
yillar <-vector()
for(i in seq(1,24)){
  yillar[i]<-evlilik_suresi[i,1]
}

yillar <- as.numeric (yillar)
yillara_gore_bs <- data.frame(
  'yil_0_1'=yillar_0_1,
  `yil_1_5` = yillar_1_5,
  `yil_6_10` = yillar_6_10,
  `yil_11_15` = yillar_11_15,
  `yil_16_20` = yillar_16_20)

yillara_gore_bs$Yil <- yillar

df_long <- yillara_gore_bs %>% pivot_longer(cols = -Yil, names_to = "Evlilik_Suresi", values_to = "Deger")
  
df_long$Evlilik_Suresi <- factor(df_long$Evlilik_Suresi,
  levels = c("yil_0_1", "yil_1_5", "yil_6_10", "yil_11_15", "yil_16_20")
)

ggplot(df_long,aes(x = Yil, y = Deger, color = Evlilik_Suresi)) +
  geom_line(linewidth = 1.2) + labs(
      title = "Yıllara Gore Bosanma Sayıları",
    x = "Yıllar",
    y = "Toplam Bosanma Sayısı"
  ) + theme_minimal(base_size = 20)+scale_x_continuous(breaks = seq(min(df_long$Yil), max(df_long$Yil), by = 1))+theme( axis.text.x = element_text(angle = 90, hjust = 1 ), plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),axis.title.x = element_text(hjust = 0.5, size = 14, face = "bold"),axis.title.y = element_text(hjust = 0.5, size = 14, face = "bold"))
  
```

```{r, fig.width=10, fig.height=8}


# Veriyi oku
df_kadin <- read_excel("veri/Kadin_Erkek_Yas_Dagilimlari_Turkiye.xlsx", sheet = "Kadın Yaş Dağılımı")

colnames(df_kadin)[3] <- "Bosanan_Kadin_Sayisi"

p5<-ggplot(df_kadin, aes(x = Yil, y = Bosanan_Kadin_Sayisi, color = Yas_Grubu, group = Yas_Grubu)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +

  labs(
    title = "Yas Dagılımlarına Gore Bosanma Sayıları (Kadın)",
    x = "Yıl",
    y = "Bosanan Kadın Sayısı",
    color = "Yas Grubu"
  )  + theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1,size=12),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14,vjust=-0.5),axis.title.x = element_text(hjust = 0.5, face = "bold", size = 14),axis.title.y = element_text(hjust = 0.5, face = "bold", size = 14))

```

```{r, fig.width=30, fig.height=10}

#bölgelere göre kadın boşanma sayılarının Scatterla Çizimi

kadin_bosanma_bolge <- read_excel("veri/yasmin-erdi/kadin_bosanma_bolge.xlsx")

kadin_bosanma_bolge$Yil <- as.numeric (kadin_bosanma_bolge$Yil)

veri_long <- kadin_bosanma_bolge %>% pivot_longer(cols = -c(Kadin_Yas_Grubu, Yil),  names_to = "Bolge", values_to = "Deger")

veri_long <- veri_long %>%
  mutate(Donem = case_when(
    Yil %in% 2001:2006 ~ "2001–2006",
    Yil %in% 2007:2012 ~ "2007–2012",
    Yil %in% 2013:2018 ~ "2013–2018",
    Yil %in% 2019:2024 ~ "2019–2024",
    TRUE ~ NA_character_
  )) %>% filter(!is.na(Donem))

ggplot(veri_long, aes(x = Deger , y = Kadin_Yas_Grubu, color = Bolge)) +
  geom_point(position = position_jitter(width = 0.1), size = 3, alpha = 1) +
  facet_wrap(~ Donem, ncol = 2) +
  labs(title = "Kadın Yaş Gruplarına Gore Bolgesel Dağılımlar (2001–2024)",
    x = "Bosanma Sayısı",
    y = "Kadın Yaş Aralıkları",
    color = "Bolge") +theme_minimal(base_size = 15) +theme(axis.text.x = element_text(angle = 0, hjust = 1),axis.text.y = element_text(angle = 0, hjust = 1,vjust=1),plot.title=element_text(hjust = 0.5, face = "bold", size = 14,vjust=-0.5))+ scale_x_continuous(limits = c(0, 20000),         
    breaks = seq(0, 20000, 5000))+scale_color_manual(values = c(
  "Akdeniz" = "#D5006D",
  "Dogu_Anadolu" ="#1E90FF",
  "Ege" = "#009E73",
  "Guneydogu_Anadolu" = "#F0E442",
  "Ic_Anadolu" = "#40E0D0",
  "Karadeniz" = "#D55E00",
  "Marmara" ="purple"
))
```

```{r, fig.width=12, fig.height=10}
erkek_bosanma_bolge <- read_excel("veri/yasmin-erdi/erkek_bosanma_bolge.xlsx")

#bölgelere göre erkek boşanma sayılarının Scatterla Çizimi
erkek_bosanma_bolge$Yil <- as.numeric (erkek_bosanma_bolge$Yil)

veri_long1 <- erkek_bosanma_bolge %>% pivot_longer(cols = -c(Erkek_Yas_Grubu, Yil),  names_to = "Bolge", values_to = "Deger")

# mutate fonksiyonuyla yıllar 6 yıllık periyotlara bölündü ve sutün olarak eklendi
veri_long1 <- veri_long1 %>%
  mutate(Donem = case_when(
    Yil %in% 2001:2006 ~ "2001–2006",
    Yil %in% 2007:2012 ~ "2007–2012",
    Yil %in% 2013:2018 ~ "2013–2018",
    Yil %in% 2019:2024 ~ "2019–2024",
    TRUE ~ NA_character_
  )) %>%
  filter(!is.na(Donem))

ggplot(veri_long1, aes(x = Deger , y = Erkek_Yas_Grubu, color = Bolge)) +
  geom_point(position = position_jitter(width = 0.1), size = 3, alpha = 1) +
  facet_wrap(~ Donem, ncol = 2) +
  labs(title = "Erkek Yaş Gruplarına Gore Bolgesel Dağılım (2001–2024)",
    x = "Bosanma Sayısı",
    y = "Erkek Yaş Aralığı",
    color = "Bolge") +theme_minimal(base_size = 15) +theme(axis.text.x = element_text(angle = 0, hjust = 1),axis.text.y = element_text(angle = 0, hjust = 1,vjust=1),plot.title=element_text(hjust = 0.5, face = "bold", size = 14,vjust=-0.5))+ scale_x_continuous(limits = c(0, 22000),         
    breaks = seq(0, 20000, 5000))+scale_color_manual(values = c(
  "Akdeniz" = "#D5006D",
  "Dogu_Anadolu" ="#1E90FF",
  "Ege" = "#009E73",
  "Guneydogu_Anadolu" = "#F0E442",
  "Ic_Anadolu" = "#40E0D0",
  "Karadeniz" = "#D55E00",
  "Marmara" ="purple"
))
```

```{r, fig.width=10, fig.height=6}
#türkiye geneli eşler arası yaş farkı (yasmin-erdi)

Yas_Farki_Turkiye_geneli <- read_excel("veri/yasmin-erdi/Yas_Farki_Turkiye_geneli.xlsx")

Yas_Farki_Turkiye_geneli$Yil <- as.numeric(Yas_Farki_Turkiye_geneli$Yil)

Yas_Farki_0_yils <- mean(Yas_Farki_Turkiye_geneli[[2]], na.rm = TRUE)
Yas_Farki_1_5_yils <- mean(Yas_Farki_Turkiye_geneli[[3]], na.rm = TRUE)
Yas_Farki_6_10_yils <- mean(Yas_Farki_Turkiye_geneli[[4]], na.rm = TRUE)
Yas_Farki_11s <- mean(Yas_Farki_Turkiye_geneli[[5]], na.rm = TRUE)
Esler_arasi_yas_farki <- data.frame(
  kategori = c("0 yıl", "1-5 yıl", "6-10 yıl", "11+ yıl"),
  deger = c(Yas_Farki_0_yils, Yas_Farki_1_5_yils, Yas_Farki_6_10_yils, Yas_Farki_11s)
)
Esler_arasi_yas_farki$kategori <- reorder(Esler_arasi_yas_farki$kategori, -Esler_arasi_yas_farki$deger)
# Dikey bar grafiği oluşturma
ggplot(Esler_arasi_yas_farki, aes(x = kategori, y = deger, fill = kategori)) +
  geom_bar(stat = "identity", width = 0.5) +  
geom_text(aes(label = label_number(accuracy = 0.01)(deger)), vjust = -0.3, size = 4) +  
  labs(
    title = " Evliligin Bosanmaya Oranı (Eşler Arası Yaş Farkı Dağılımı)",
    x = "Yaş Farkı Kategorisi",
    y = "Oran",
    fill = "Kategori"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
    axis.text = element_text(size = 12,face = "bold"),
    axis.title = element_text(size = 14,face = "bold"),
    legend.title = element_text(size = 12,face = "bold"),
    legend.text = element_text(size = 12,face = "bold")
  ) 
  ylim(0, max(Esler_arasi_yas_farki$deger) * 1.1)
```

```{r, fig.width=8, fig.height=8}

# radar grafiğiyle çizim 
Yas_Farki_Turkiye_geneli_1 <- read_excel("veri/Yas_Farki_Turkiye_geneli_1.xlsx")
yasmin <- Yas_Farki_Turkiye_geneli_1
colnames(yasmin) <- c("Yil", "Yas_Farki_0_yil", "Yas_Farki_1_5_yil", "Yas_Farki_6_10_yil", "Yas_Farki_11")

data <- data.frame(
  row.names = c("Yas_Farki_0_yil", "Yas_Farki_1_5_yil", "Yas_Farki_6_10_yil", "Yas_Farki_11"),
  t(yasmin[, -1]) 
)
colnames(data) <- yasmin$Yil

data <- rbind(
  rep(max(data), ncol(data)),
  rep(0, ncol(data)),
  data
)# maximum ve mn,mum degerleri belirleme

options(scipen = 99999999)# 1000000 değerini scientfic olark gösterimini kapatmak için kullanıldı

colors <- c("black", "darkorange", "forestgreen", "steelblue")
radarchart(data,
           axistype = 1,
           pcol = colors,
           pfcol = alpha(colors, 0.3),
           plwd = 0.1,
           cglcol = "grey80",
           cglty = 1,
           axislabcol = "black",
           caxislabels = seq(0, 100000, length.out = 5),
           vlcex = 1,
           calcex=1.5
)
       legend("bottom", legend = rownames(data)[-c(1,2)],
       col = colors, lwd = 3, bty = "n", horiz = TRUE, cex = 1)
n_yillar <- ncol(data)
angles <- seq(0, 2*pi, length.out = n_yillar + 1)[-1]
radius <- 0.9
x <- radius * sin(angles)
y <- radius * cos(angles)+title(main = "Eşler Arası Yaş Farkının Yıllara Gore Gosterimi")

```
